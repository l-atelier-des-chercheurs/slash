import{n,P as _,_ as u}from"../build.js";const d={props:{has_sidebar:{type:Boolean,default:!0}},data(){return{show_sidebar:!1}}};var c=function(){var e=this,t=e._self._c;return t("section",{staticClass:"_filterableListLayout"},[t("div",{staticClass:"_filterSortBar"},[t("div",{staticClass:"_filterSortBar--leftSide"},[e._t("before-sidebar-toggle"),e.has_sidebar?t("div",{},[t("button",{staticClass:"u-button u-button_small u-button_bleumarine",class:{"is--active":e.show_sidebar},attrs:{type:"button",size:"small"},domProps:{textContent:e._s(e.show_sidebar?e.$t("hide"):e.$t("filter"))},on:{click:function(r){e.show_sidebar=!e.show_sidebar}}})]):e._e(),e._t("search"),e._t("top-left")],2),t("div",{staticClass:"_filterSortBar--rightSide"},[e._t("top-right")],2)]),t("div",{staticClass:"_cont"},[e.show_sidebar&&e.has_sidebar?t("div",{staticClass:"_sidebar"},[e._t("sidebar")],2):e._e(),t("div",{staticClass:"_listContent"},[e._t("active-filters"),e._t("list")],2)])])},f=[],p=n(d,c,f,!1,null,"471f68dc");const h=p.exports,y={props:{folders:Array,pinned_folders:{type:Array,default:()=>[]},path:String,can_edit:Boolean,pin_field_name:{type:String,default:"projects_pinned"},pin_label:{type:String,default:"Pinned"},empty_message:String,view_mode:{type:String,default:"list"}},components:{PinnedNonpinnedFolder:_}};var m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"_foldersList"},[e.folders.length===0?t("div",{key:"nofolders",staticClass:"u-instructions _noFolders"},[e._v(" "+e._s(e.empty_message||e.$t("no_projects"))+" ")]):[t("PinnedNonpinnedFolder",{attrs:{field_name:e.pin_field_name,label:e.pin_label,content:e.pinned_folders,path:e.path,folders:e.folders,can_edit:e.can_edit,direction:["medium","tiny"].includes(e.view_mode)?"grid":"list",view_mode:e.view_mode},scopedSlots:e._u([{key:"default",fn:function(r){return[e._t("default",null,{item:r.item})]}}],null,!0)})]],2)},v=[],g=n(y,m,v,!1,null,"bc8b7381");const b=g.exports,$={props:{folders:Array,pinned_folders:Array,path:String,can_edit:Boolean,folder_type:{type:String,default:"project"},pin_field_name:String,pin_label:String,empty_message:String,display_original_space:Boolean,available_view_modes:{type:Array,default:()=>["list","medium","map","tiny"]}},components:{FilterableListLayout:h,FoldersList:b,DisplayOnMap:()=>u(()=>import("./DisplayOnMap-DFMAPZ5V.js"),[])},data(){return{search_query:"",order_key:"$date_created",current_view_mode:"medium",filter_by_group:""}},created(){},watch:{current_view_mode(s){s&&localStorage.setItem(this.view_mode_saved_key,s)},search_query(s){localStorage.setItem(this.search_query_saved_key,s)},order_key(s){localStorage.setItem(this.order_key_saved_key,s)},filter_by_group(s){localStorage.setItem(this.filter_by_group_saved_key,s)},folder_type:{immediate:!0,handler(){this.folder_type==="author"&&(this.order_key="alphabetical"),this.loadSettings()}}},computed:{view_mode_saved_key(){return"folders_view_mode_"+this.folder_type.toLowerCase()},search_query_saved_key(){return"folders_search_query_"+this.folder_type.toLowerCase()},order_key_saved_key(){return"folders_order_key_"+this.folder_type.toLowerCase()},filter_by_group_saved_key(){return"folders_filter_by_group_"+this.folder_type.toLowerCase()},view_mode(){return!0},search_placeholder(){return this.folder_type==="project"?this.$t("search_in_title_desc_kw"):this.folder_type==="publication"?this.$t("search_in_title"):this.$t("search_by_name")},order_options(){return[{key:"$date_created",text:this.$t("date_created")},{key:"$date_modified",text:this.$t("date_modified")},{key:"alphabetical",text:this.$t("alphabetical")}]},sorted_folders(){return this.folders?this.folders.slice().filter(s=>this.canLoggedinSeeFolder({folder:s})).sort((s,e)=>{if(this.folder_type==="project"){if(s.$status!=="finished"&&e.$status==="finished")return 1;if(s.$status==="finished"&&e.$status!=="finished")return-1}if(this.order_key==="$date_created")return+new Date(e.$date_created)-+new Date(s.$date_created);if(this.order_key==="$date_modified")return+new Date(e.$date_modified)-+new Date(s.$date_modified);if(this.order_key==="alphabetical"){const t=s.title||s.name||"",r=e.title||e.name||"";return t.localeCompare(r)}}):[]},active_filters(){var e;let s=[];return(e=this.$route.query)!=null&&e.pfilters&&JSON.parse(this.$route.query.pfilters).map(r=>{s.push({filter_type:r.filter_type,value:decodeURI(r.value)})}),s},opened_event(){return this.$route.hash.substring(1)||!1},filtered_folders(){return this.sorted_folders.filter(s=>{var e,t,r;if(this.search_query){if(this.folder_type==="project"){if(!this.searchInProject(s))return!1}else if(this.folder_type==="publication"){if(!this.twoStringsSearch(s.title,this.search_query))return!1}else if(!this.twoStringsSearch(s.name,this.search_query))return!1}if(this.current_view_mode==="map"&&(!s.$location||!s.$location.latitude))return!1;if(this.folder_type==="project"){for(const i of this.active_filters){const a=i.filter_type,l=i.value;if(a==="authors"){const o=this.getAuthor(l);if(!o||!((e=s.$contributors)!=null&&e.includes(o.$path))&&!((t=s.$admins)!=null&&t.includes(o.$path)))return!1}else if(!Object.prototype.hasOwnProperty.call(s,a))return!1;if(Array.isArray(s[a])&&!s[a].includes(l))return!1;if(typeof s[a]=="string"&&s[a]!==l)return!1}if(this.opened_event&&this.opened_event!==s.event_linked_slug)return!1}return!(this.folder_type==="author"&&this.filter_by_group&&!((r=s.group)!=null&&r.includes(this.filter_by_group)))})},project_admins_and_contributors(){if(this.folder_type!=="project")return[];const s=this.extractArr(this.filtered_folders,"$admins"),e=this.extractArr(this.filtered_folders,"$contributors");return[...s,...e].reduce((t,r)=>{const i=this.getAuthor(r);return i&&!t.some(a=>a.$path===i.$path)&&t.push(i),t},[]).sort((t,r)=>t.name.localeCompare(r.name))},all_groups(){return this.folder_type!=="author"?[]:this.sorted_folders.reduce((s,e)=>{var t;return(t=e.group)==null||t.map(r=>{s.some(i=>i===r)||r&&s.push(r)}),s},[]).sort((s,e)=>s.localeCompare(e))},map_pins(){const s="#142257";return this.filtered_folders.reduce((e,t)=>{if(t.$location){const{latitude:r,longitude:i}=t.$location;r&&i&&e.push({latitude:r,longitude:i,path:t.$path,label:t.title||t.name,color:s,pin_preview:"text"})}return e},[])},show_sidebar_toggle(){return this.folder_type==="author"?this.all_groups.length>0:this.folder_type==="publication"||this.folder_type==="space"?this.$slots.sidebar||!1:!0}},methods:{loadSettings(){this.current_view_mode=localStorage.getItem(this.view_mode_saved_key)||"medium",this.search_query=localStorage.getItem(this.search_query_saved_key)||"";const s=localStorage.getItem(this.order_key_saved_key);s&&(this.order_key=s),this.filter_by_group=localStorage.getItem(this.filter_by_group_saved_key)||""},extractAll(s){return this.extractArr(this.filtered_folders,s)},toggleFilter({filter_type:s,value:e}){let t={};this.$route.query&&(t=JSON.parse(JSON.stringify(this.$route.query)));let r=t.pfilters?JSON.parse(t.pfilters):[];e&&!r.some(a=>a.filter_type===s&&a.value===encodeURI(e))?r.push({filter_type:s,value:encodeURI(e)}):r=r.filter(a=>!(a.filter_type===s&&a.value===encodeURI(e)));const i=this.$route.hash||!1;r.length>0?t.pfilters=JSON.stringify(r):delete t.pfilters,this.$router.push({query:t,hash:i})},resetFilters(){var t;let s={};const e=this.$route.hash||!1;(t=this.$route.query)!=null&&t.pfilters&&(s=JSON.parse(JSON.stringify(this.$route.query)),delete s.pfilters),this.$router.push({query:s,hash:e})},getActiveTags(s){return this.active_filters?this.active_filters.reduce((e,t)=>(t.filter_type===s&&e.push(t.value),e),[]):[]},toggleGroupFilter(s){this.filter_by_group=s===this.filter_by_group?"":s},searchInProject(s){if(s.title&&this.twoStringsSearch(s.title,this.search_query)||s.description&&this.twoStringsSearch(s.description,this.search_query))return!0;for(const e of["keywords","machines","materials"])if(s[e]&&s[e].some(t=>this.twoStringsSearch(t,this.search_query)))return!0;return!1},pinClicked(s){const e=this.createURLFromPath(s);this.$router.push(e)}}};var k=function(){var e=this,t=e._self._c;return t("FilterableListLayout",{staticClass:"_foldersListWithFilter",attrs:{has_sidebar:e.sorted_folders.length>0&&e.show_sidebar_toggle},scopedSlots:e._u([{key:"before-sidebar-toggle",fn:function(){return[e._t("before-sidebar-toggle")]},proxy:!0},e.sorted_folders.length>0?{key:"search",fn:function(){return[t("div",{staticClass:"_searchField"},[t("SearchInput",{attrs:{search_placeholder:e.search_placeholder,name:"search_folder"},model:{value:e.search_query,callback:function(r){e.search_query=r},expression:"search_query"}})],1)]},proxy:!0}:null,{key:"top-right",fn:function(){return[t("div",{staticClass:"_topRightControls"},[e.sorted_folders.length>0?[t("select",{directives:[{name:"model",rawName:"v-model",value:e.order_key,expression:"order_key"}],staticClass:"_orderSelect",attrs:{size:"small",name:"order_folders",disabled:e.filtered_folders.length<=1},on:{change:function(r){var i=Array.prototype.filter.call(r.target.options,function(a){return a.selected}).map(function(a){var l="_value"in a?a._value:a.value;return l});e.order_key=r.target.multiple?i:i[0]}}},e._l(e.order_options,function(r){return t("option",{key:r.key,domProps:{value:r.key,textContent:e._s(r.text)}})}),0)]:e._e(),e.view_mode?t("div",{staticClass:"_mode"},[e.available_view_modes.includes("list")?t("button",{staticClass:"u-button u-button_icon",class:{"is--active":e.current_view_mode==="list"},attrs:{type:"button"},on:{click:function(r){e.current_view_mode="list"}}},[t("b-icon",{attrs:{icon:"list-ol"}})],1):e._e(),e.available_view_modes.includes("tiny")?t("button",{staticClass:"u-button u-button_icon",class:{"is--active":e.current_view_mode==="tiny"},attrs:{type:"button"},on:{click:function(r){e.current_view_mode="tiny"}}},[t("b-icon",{attrs:{icon:"grid-3x2-gap-fill"}})],1):e._e(),e.available_view_modes.includes("medium")?t("button",{staticClass:"u-button u-button_icon",class:{"is--active":e.current_view_mode==="medium"},attrs:{type:"button"},on:{click:function(r){e.current_view_mode="medium"}}},[t("b-icon",{attrs:{icon:"grid-fill"}})],1):e._e(),e.available_view_modes.includes("map")?t("button",{staticClass:"u-button u-button_icon",class:{"is--active":e.current_view_mode==="map"},attrs:{type:"button",disabled:e.map_pins.length===0},on:{click:function(r){e.current_view_mode="map"}}},[t("b-icon",{attrs:{icon:"map-fill"}})],1):e._e()]):e._e(),e._t("top-right")],2)]},proxy:!0},{key:"sidebar",fn:function(){return[e.folder_type==="project"?[t("div",[t("DLabel",{attrs:{str:e.$t("status")}}),t("div",{staticClass:"_statusList"},e._l(e.extractAll("$status"),function(r){return t("StatusTag",{key:r,attrs:{status:r,can_edit:!1,mode:e.getActiveTags("$status").includes(r)?"disable":"active"},on:{click:function(i){return e.toggleFilter({filter_type:"$status",value:r})}}})}),1)],1),t("div",[t("DLabel",{attrs:{str:e.$t("contributors")}}),t("TagsList",{attrs:{tags:e.project_admins_and_contributors,tag_type:"authors",tags_active:e.getActiveTags("authors")},on:{tagClick:function(r){return e.toggleFilter({filter_type:"authors",value:r})}}})],1),e._l(["target_audience","disciplines","level","keywords","machines","materials"],function(r){return[e.extractAll(r).length>0?t("div",{key:r},[r==="level"?[t("DLabel",{attrs:{str:e.$t("levels_and_competences")}}),t("TagsList",{attrs:{tags:e.extractAll("level"),tag_type:"level",tags_active:e.getActiveTags("level")},on:{tagClick:function(i){return e.toggleFilter({filter_type:"level",value:i})}}})]:[t("DLabel",{attrs:{str:e.$t(r)}}),t("TagsList",{attrs:{tags:e.extractAll(r),tag_type:r,tags_active:e.getActiveTags(r)},on:{tagClick:function(i){return e.toggleFilter({filter_type:r,value:i})}}})]],2):e._e()]})]:e._e(),e.folder_type==="author"?[e.all_groups.length>0?t("div",[t("DLabel",{attrs:{str:e.$t("group")}}),t("TagsList",{attrs:{tags:e.all_groups,tag_type:"accountgroup",tags_active:[e.filter_by_group]},on:{tagClick:function(r){return e.toggleGroupFilter(r)}}})],1):e._e()]:e._e(),e._t("sidebar")]},proxy:!0},{key:"active-filters",fn:function(){return[t("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[e.active_filters.length>0?t("transition-group",{staticClass:"_tagList",attrs:{tag:"section",name:"listComplete",appear:""}},[e._l(e.active_filters,function(r){return[r.filter_type==="$status"?t("StatusTag",{key:"status_"+r.value,attrs:{status:r.value,can_edit:!1,mode:"disable"},on:{click:function(i){return e.toggleFilter({filter_type:"$status",value:r.value})}}}):r.filter_type==="authors"?t("AuthorTag",{key:"authors_"+r.value,attrs:{path:r.value,mode:"disable"},on:{click:function(i){return e.toggleFilter({filter_type:"authors",value:r.value})}}}):t("SingleTag",{key:r.filter_type+"_"+r.value,attrs:{tag_type:r.filter_type,tag_str:r.value,mode:"disable"},on:{tagClick:function(i){return e.toggleFilter({filter_type:r.filter_type,value:r.value})}}})]}),e.active_filters.length>1?t("button",{key:"reset_all",staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:e.resetFilters}},[e._v(" "+e._s(e.$t("reset_all"))+" ")]):e._e()],2):e._e()],1)]},proxy:!0},{key:"list",fn:function(){return[e._t("list-header"),e.current_view_mode==="list"||e.current_view_mode==="medium"||e.current_view_mode==="tiny"?[t("FoldersList",{attrs:{folders:e.filtered_folders,pinned_folders:e.pinned_folders,path:e.path,can_edit:e.can_edit,pin_field_name:e.pin_field_name,pin_label:e.pin_label,empty_message:e.empty_message,view_mode:e.current_view_mode},scopedSlots:e._u([{key:"default",fn:function(r){return[e._t("item",null,{item:r.item,view_mode:e.current_view_mode})]}}],null,!0)})]:e.current_view_mode==="map"?[t("div",{staticClass:"_mapContainer"},[t("DisplayOnMap",{attrs:{pins:e.map_pins,map_baselayer_opacity:.5,map_baselayer_bw:!0,is_small:!1},on:{"update:opened_pin_path":function(r){return e.pinClicked(r)}}})],1)]:e._e()]},proxy:!0}],null,!0)})},w=[],S=n($,k,w,!1,null,"a31dfea6");const F=S.exports;export{F};
