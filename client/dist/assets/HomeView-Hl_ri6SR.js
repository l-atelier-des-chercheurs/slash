import{n,B as c,_ as a,D as l}from"../build.js";import{S as d}from"./SpacePresentation-C73OEN1E.js";import{F as r}from"./FoldersListWithFilter-DWnu_erJ.js";import{P as p}from"./ProjectPresentation-iBZnXivM.js";import m from"./AdminSettings-BqfaQVEF.js";import{P as u}from"./PublicationPreview-DPMoJ-fU.js";import{D as h}from"./DynamicTitle-CpTdDlYg.js";const f={props:{},components:{SpacePresentation:d,BinFolder:c,FoldersListWithFilter:r},data(){return{settings:void 0,spaces:void 0,path:"spaces",fetch_spaces_error:void 0,show_create_modal:!1,is_loading:!0,show_bin_modal:!1}},created(){},async mounted(){this.settings=await this.$api.getFolder({path:""}).catch(s=>s),this.$api.join({room:"."}),this.spaces=await this.$api.getFolders({path:this.path}).catch(s=>{this.fetch_spaces_error=s.response}),this.$api.join({room:this.path}),this.is_loading=!1},beforeDestroy(){this.$api.leave({room:"."}),this.$api.leave({room:this.path})},watch:{},computed:{},methods:{openNewSpace(s){this.show_create_modal=!1;const t=this.createURLFromPath(this.path+"/"+s);this.$router.push(t)}}};var g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_spacesList"},[t.is_loading?e("div",{staticClass:"_loadingContainer"},[e("LoaderSpinner")],1):e("FoldersListWithFilter",{ref:"foldersList",attrs:{folders:t.spaces,pinned_folders:t.settings.spaces_pinned,path:t.path,can_edit:t.is_instance_admin,folder_type:"space",pin_field_name:"spaces_pinned",pin_label:t.$t("spaces_pinned"),empty_message:t.$t("no_spaces"),available_view_modes:["medium","map"]},scopedSlots:t._u([{key:"before-sidebar-toggle",fn:function(){return[t.is_instance_admin||t.is_instance_contributor?e("button",{staticClass:"u-button u-button_red u-button_small",attrs:{type:"button"},on:{click:function(i){t.show_create_modal=!0}}},[e("b-icon",{attrs:{icon:"plus",label:t.$t("create")}}),t._v(" "+t._s(t.$t("create"))+" ")],1):t._e()]},proxy:!0},{key:"item",fn:function({item:i,view_mode:o}){return[e("SpacePresentation",{attrs:{space:i,context:o,can_edit:!1}})]}}])}),t.is_instance_admin?[e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(i){t.show_bin_modal=!0}}},[e("b-icon",{attrs:{icon:"recycle"}}),t._v(" "+t._s(t.$t("bin"))+" ")],1),t.show_bin_modal?e("BinFolder",{attrs:{modal_title:t.$t("restore_spaces"),path:"spaces"},on:{close:function(i){t.show_bin_modal=!1}},scopedSlots:t._u([{key:"default",fn:function(i){return[e("SpacePresentation",{attrs:{space:i.project,context:i.context,can_edit:i.can_edit}})]}}],null,!1,2360877550)}):t._e()]:t._e(),t.show_create_modal?e("CreateFolder",{attrs:{modal_name:t.$t("create_a_space"),path:"spaces"},on:{close:function(i){t.show_create_modal=!1},openNew:t.openNewSpace}}):t._e()],2)},b=[],v=n(f,g,b,!1,null,"31ca90a0");const $=v.exports,y={props:{show_only_my_projects:Boolean},components:{FoldersListWithFilter:r,ProjectPresentation:p},data(){return{all_projects:[],is_loading:!0}},created(){},async mounted(){this.all_projects=await this.loadAllFolders("spaces","projects")||[],this.is_loading=!1},beforeDestroy(){},watch:{},computed:{filtered_projects(){let s=this.all_projects;return this.show_only_my_projects&&(s=s.filter(t=>{var e,i;return t?!!(Array.isArray(t.$admins)&&((e=t.$admins)!=null&&e.includes(this.connected_as.$path))||Array.isArray(t.$contributors)&&((i=t.$contributors)!=null&&i.includes(this.connected_as.$path))):!1})),s}},methods:{toggleFilter(s){this.$refs.listWithFilter&&this.$refs.listWithFilter.toggleFilter(s)}}};var P=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_allProjects"},[e("transition",{attrs:{name:"fade_fast",duration:150,mode:"out-in"}},[t.is_loading?e("LoaderSpinner"):e("FoldersListWithFilter",{ref:"listWithFilter",attrs:{folders:t.filtered_projects,display_original_space:!0,folder_type:"project",available_view_modes:["tiny","medium","map"]},scopedSlots:t._u([{key:"item",fn:function({item:i,view_mode:o}){return[e("ProjectPresentation",{attrs:{project:i,context:o,display_original_space:!0,can_edit:!1},on:{toggleFilter:function(_){return t.toggleFilter(_)}}})]}}])})],1)],1)},x=[],w=n(y,P,x,!1,null,"df72f82b");const C=w.exports,j={name:"HomeTopHero",components:{AdminSettings:m},data(){return{settings_modal_starting_tab:void 0,show_settings_modal:!1}},computed:{name(){return this.$root.app_infos.instance_meta.name},description(){return this.$root.app_infos.instance_meta.presentation},hero_thumb(){return this.$root.app_infos.instance_meta.hero_thumb||!1},text_image_layout(){return this.$root.app_infos.instance_meta.text_image_layout||"image_text"},custom_layout(){return this.text_image_layout==="text_image"?["text","image"]:this.text_image_layout==="image_text"?["image","text"]:["text","image"]}},methods:{editHeroImage(){this.settings_modal_starting_tab="logo_and_images",this.show_settings_modal=!0},editPresentationText(){this.settings_modal_starting_tab="informations",this.show_settings_modal=!0},closeAdminSettings(){this.show_settings_modal=!1,this.settings_modal_starting_tab=void 0}}};var F=function(){var t=this,e=t._self._c;return e("section",{staticClass:"_hero--container"},[e("div",{staticClass:"_hero--content",attrs:{"data-layout":t.text_image_layout}},[t._l(t.custom_layout,function(i){return[i==="text"?e("div",{key:i,staticClass:"_textBlock"},[e("h1",{staticClass:"_sessionTitle",domProps:{textContent:t._s(t.name||t.$t("welcome_to_dodoc"))}}),e("div",{},[t.description?e("CollaborativeEditor3",{attrs:{content:t.description}}):[t.is_instance_admin?[e("p",{domProps:{innerHTML:t._s(t.$t("admins_edit_text_below"))}})]:[e("p",{domProps:{innerHTML:t._s(t.$t("admins_edit_text_here"))}})]]],2),t.$root.app_infos.instance_meta.contactmail?[e("div",{staticClass:"u-spacingBottom"}),e("p",[e("b",[t._v(t._s(t.$t("contactmail_of_instance")))]),t._v("Â  "),e("a",{attrs:{href:"mailto:"+t.$root.app_infos.instance_meta.contactmail,target:"_blank"}},[t._v(t._s(t.$root.app_infos.instance_meta.contactmail))])])]:t._e(),t.is_instance_admin?e("EditBtn",{staticClass:"_editAdminText",attrs:{label_position:"left"},on:{click:t.editPresentationText}}):t._e()],2):t._e(),i==="image"&&t.hero_thumb?e("div",{key:i,staticClass:"_imageBlock"},[e("img",{attrs:{src:t.hero_thumb,role:"presentation"}})]):t._e()]}),t.is_instance_admin?e("EditBtn",{staticClass:"_editAdminImg",attrs:{label_position:"left"},on:{click:t.editHeroImage}}):t._e()],2),t.show_settings_modal?e("AdminSettings",{attrs:{starting_tab:t.settings_modal_starting_tab},on:{close:t.closeAdminSettings}}):t._e(),e("svg",{staticClass:"_hidden"},[e("clipPath",{attrs:{id:"clipPathSquircle",clipPathUnits:"objectBoundingBox"}},[e("path",{attrs:{transform:"scale(1 1.835)",d:"M 0.114 0.045 h 0.773 c 0.055 0 0.068 0.013 0.068 0.068 v 0.318 c 0 0.055 -0.013 0.068 -0.068 0.068 h -0.773 c -0.055 0 -0.068 -0.013 -0.068 -0.068 v -0.318 c 0 -0.055 0.013 -0.068 0.068 -0.068"}})])])],1)},k=[],L=n(j,F,k,!1,null,"1d6b2b6f");const S=L.exports,T={name:"GetPinnedPublications",components:{PublicationPreview:u,SectionWithPrint:()=>a(()=>import("./SectionWithPrint-GZ1RHvU_.js"),[])},data(){return{pinnedPublications:[],publication_to_open:null}},created(){this.fetchPinnedPublications(),this.fetchPublicationToOpen()},methods:{async fetchPublicationToOpen(){const s=await this.$api.getFolder({path:"spaces/casou/projects/julien/publications/lkj"});this.publication_to_open=s},async fetchPinnedPublications(){const s=await this.loadAllFolders("spaces","projects","publications");this.pinnedPublications=s.slice(0,5)}}};var A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_allPublications"},[e("h2",[t._v(t._s(t.$t("all_publications")))]),t.pinnedPublications.length>0?e("div",{staticClass:"_allPublications--grid"},t._l(t.pinnedPublications,function(i){return e("div",{staticClass:"_allPublications--grid--card"},[e("PublicationPreview",{attrs:{publication:i,template_options:[],can_edit:!1},on:{open:function(o){return t.openEntry(i.$path)}}})],1)}),0):e("p",{staticClass:"no-publications"},[t._v(t._s(t.$t("no_pinned_publications")))])])},H=[],E=n(T,A,H,!1,null,"5a97506a");const R=E.exports,B={props:{},mixins:[h],components:{HomeTopHero:S,EventsSection:()=>a(()=>import("./EventsSection-DlWPJg70.js"),[]),SpacesList:$,AllProjects:C,DodocLogo:l,RecentlyEdited:()=>a(()=>import("./RecentlyEdited-DYFfRr4i.js"),[]),AllPublications:R},data(){return{load_whole_page:!1,current_mode:"spaces"}},created(){var s;((s=this.$route.query)!=null&&s.pfilters||this.opened_event)&&(this.current_mode="projects"),this.$api.updateSelfPath("/")},mounted(){this.updateDocumentTitle(),setTimeout(()=>{this.load_whole_page=!0},100)},beforeDestroy(){},watch:{current_mode(){var s;if(this.current_mode==="spaces"&&(s=this.$route.query)!=null&&s.pfilters){let t=JSON.parse(JSON.stringify(this.$route.query));delete t.pfilters,this.$router.push({query:t})}},opened_event:{handler(){this.opened_event&&(this.current_mode="projects")}}},computed:{opened_event(){return this.$route.hash.substring(1)||!1},available_radioswitch_modes(){let s=[{label:this.$t("spaces"),value:"spaces"},{label:this.$t("all_projects"),value:"projects"}];return this.connected_as&&s.push({label:this.$t("my_projects"),value:"my_projects"}),s},name(){return this.$root.app_infos.instance_meta.name},description(){return this.$root.app_infos.instance_meta.presentation},hero_thumb(){return this.$root.app_infos.instance_meta.hero_thumb||!1},customStyling(){let s={};return this.$root.app_infos.instance_meta.hero_background_color&&(s["--hero-bg"]=this.$root.app_infos.instance_meta.hero_background_color),this.$root.app_infos.instance_meta.text_background_color&&(s["--text-bg"]=this.$root.app_infos.instance_meta.text_background_color),s},text_image_layout(){return this.$root.app_infos.instance_meta.text_image_layout||"image_text"},custom_layout(){return this.text_image_layout==="text_image"?["text","image"]:this.text_image_layout==="image_text"?["image","text"]:["text","image"]}},methods:{showCredits(){this.$eventHub.$emit("toolbar.openCredits")}}};var D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_homeView",style:t.customStyling},[e("HomeTopHero"),t.load_whole_page===!0?[t.connected_as?e("RecentlyEdited"):t._e(),t.$root.app_infos.instance_meta.enable_events?e("section",[e("EventsSection")],1):t._e(),e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[e("div",{key:t.opened_event,staticClass:"_bottomCont"},[t.opened_event?t._e():e("RadioSwitch",{staticClass:"_switch",attrs:{content:t.current_mode,options:t.available_radioswitch_modes},on:{"update:content":function(i){t.current_mode=i}}}),e("transition",{attrs:{name:"pagechange",mode:"out-in"}},[e("div",{key:t.current_mode},[t.current_mode==="spaces"?[e("div",{staticClass:"u-instructions _content"},[e("small",{domProps:{innerHTML:t._s(t.$t("spaces_instr"))}})]),e("SpacesList")]:t.current_mode==="projects"?[e("div",{staticClass:"u-instructions _content"},[t.opened_event?[e("h2",[t._v(t._s(t.$t("list_of_projects")))])]:e("small",{domProps:{innerHTML:t._s(t.$t("all_projects_instr"))}})],2),e("AllProjects")]:t.current_mode==="my_projects"?[e("div",{staticClass:"u-instructions _content"},[e("small",{domProps:{innerHTML:t._s(t.$t("my_projects_instr"))}})]),e("AllProjects",{attrs:{show_only_my_projects:!0}})]:t._e()],2)])],1)]),e("footer",{staticClass:"_bottomFooter"},[e("div",{staticClass:"_bottomFooter--cont"},[t.$root.app_infos.instance_meta.terms_in_footer||t.$root.app_infos.instance_meta.confidentiality_in_footer?e("div",{staticClass:"u-spacingBottom _links"},[t.$root.app_infos.instance_meta.terms_in_footer?e("router-link",{staticClass:"u-buttonLink",attrs:{to:t.createURLFromPath("pages/terms")}},[t._v(" "+t._s(t.$t("terms"))+" ")]):t._e(),t.$root.app_infos.instance_meta.confidentiality_in_footer?e("router-link",{staticClass:"u-buttonLink",attrs:{to:t.createURLFromPath("pages/confidentiality")}},[t._v(" "+t._s(t.$t("confidentiality"))+" ")]):t._e()],1):t._e(),e("div",{staticClass:"_logoText"},[e("DodocLogo",{staticClass:"_logo"}),e("div",{staticClass:"_version"},[t._v(" "+t._s(t.$t("version"))+" "+t._s(t.$root.app_infos.version)+" ")])],1),e("p",{domProps:{innerHTML:t._s(t.$t("a_foss_made_by"))}}),e("button",{staticClass:"u-buttonLink u-button_small",attrs:{type:"button"},on:{click:t.showCredits}},[e("span",{domProps:{innerHTML:t._s(t.$t("more_informations"))}})])])])]:t._e()],2)},M=[],O=n(B,D,M,!1,null,"a0441112");const z=O.exports;export{z as default};
