import{n,_ as s}from"../build.js";const a={props:{field_name:String,label:{type:String,default:""},instructions:{type:String,default:""},content:Object,path:String,can_edit:Boolean},components:{DisplayOnMap:()=>s(()=>import("./DisplayOnMap-CY2ZDQCe.js"),[])},data(){return{edit_mode:!1,longitude:"",latitude:"",zoom:0}},created(){},mounted(){},beforeDestroy(){},watch:{content:{handler(){this.initLongLatZoom()},deep:!0,immediate:!0}},computed:{allow_save(){var i,t,e;return this.longitude!==((i=this.content)==null?void 0:i.longitude)||this.latitude!==((t=this.content)==null?void 0:t.latitude)||this.zoom!==((e=this.content)==null?void 0:e.zoom)},pins(){if(this.content){const{longitude:i,latitude:t}=this.content;if(i&&t)return[{longitude:i,latitude:t}]}return[]},map_key(){return this.content?JSON.stringify(this.content):"k"}},methods:{enableEditMode(){this.edit_mode=!0},removePosition(){this.longitude=void 0,this.latitude=void 0,this.zoom=void 0,this.updateLongLatZoom()},newPositionClicked({longitude:i,latitude:t,zoom:e}){this.longitude=i,this.latitude=t,this.zoom=e},zoomUpdated(i){this.zoom=i},async updateLongLatZoom(){let i={};if((this.longitude||this.latitude||this.zoom)&&(i={longitude:this.longitude,latitude:this.latitude,zoom:this.zoom}),this.$emit("newPosition",i),this.path){const t={[this.field_name]:i};await this.$api.updateMeta({path:this.path,new_meta:t})}this.edit_mode=!1},initLongLatZoom(){var i,t,e;(i=this.content)!=null&&i.longitude&&((t=this.content)!=null&&t.latitude)&&(this.longitude=this.content.longitude,this.latitude=this.content.latitude),this.zoom=((e=this.content)==null?void 0:e.zoom)||2},cancel(){this.initLongLatZoom(),this.edit_mode=!1}}};var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"_positionPicker"},[t.label?e("DLabel",{staticClass:"_label",attrs:{str:t.label,instructions:t.can_edit?t.instructions:""}}):t._e(),e("div",{},[t.edit_mode?e("div",[e("span",{staticClass:"u-instructions"},[t._v(" "+t._s(t.$t("click_on_map_to_repick_location"))+" ")]),e("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.removePosition}},[t._v(" "+t._s(t.$t("cancel_position"))+" ")])]):t._e(),t.edit_mode?[e("SaveCancelButtons",{staticClass:"_scb",attrs:{allow_save:t.allow_save},on:{save:t.updateLongLatZoom,cancel:t.cancel}})]:t._e(),t.pins.length>0||t.edit_mode?e("DisplayOnMap",{key:t.map_key,attrs:{pins:t.pins,start_zoom:t.zoom,can_click:t.edit_mode},on:{newPositionClicked:t.newPositionClicked,zoomUpdated:t.zoomUpdated}}):e("div",{staticClass:"u-instructions"},[t._v(" "+t._s(t.$t("no_position"))+" ")]),!t.edit_mode&&t.can_edit?e("div",{staticClass:"_editBtn"},[e("EditBtn",{attrs:{label_position:"left",btn_type:t.pins.length===0?"add":"edit",is_unfolded:t.pins.length===0},on:{click:t.enableEditMode}})],1):t._e(),t.pins.length>0||t.edit_mode?e("details",[e("summary",{staticClass:"u-buttonLink"},[t._v(" "+t._s(t.$t("more_informations"))+" ")]),e("div",{staticClass:"u-sameRow"},[e("div",{},[e("DLabel",{attrs:{str:t.$t("latitude")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.latitude,expression:"latitude"}],attrs:{placeholder:t.$t("latitude"),size:"small",type:"text",disabled:!t.edit_mode,"help-text":`Latitude, par exemple : 64.138 ou 64째 8' 16.8" N`},domProps:{value:t.latitude},on:{input:function(o){o.target.composing||(t.latitude=o.target.value)}}}),e("span",{staticClass:"u-suffix"},[t._v("째")])])],1),e("div",{},[e("DLabel",{attrs:{str:t.$t("longitude")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.longitude,expression:"longitude"}],attrs:{placeholder:t.$t("longitude"),size:"small",type:"text",disabled:!t.edit_mode,"help-text":`Longitude, par exemple : -21.877 ou 21째 52' 37.199" O`},domProps:{value:t.longitude},on:{input:function(o){o.target.composing||(t.longitude=o.target.value)}}}),e("span",{staticClass:"u-suffix"},[t._v("째")])])],1),e("div",{},[e("DLabel",{attrs:{str:t.$t("zoom")}}),e("div",{staticClass:"u-inputGroup"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.zoom,expression:"zoom"}],attrs:{placeholder:t.$t("zoom"),size:"small",type:"text",disabled:!t.edit_mode,"help-text":"Niveau de zoom"},domProps:{value:t.zoom},on:{input:function(o){o.target.composing||(t.zoom=o.target.value)}}})])],1)])]):t._e()],2)],1)},l=[],u=n(a,d,l,!1,null,"0cb8af40");const c=u.exports;export{c as default};
